@model int

<h1>@TestApp.MVC.Controllers.ChatsController.Rooms.GetValueOrDefault(Model)</h1>
<div class="row">
    <div class="col-12">
        <br/>
        <input style="width: 200px;" type="text" placeholder="Usuario" id="user" /><br /><br />
        <input style="width: 1000px;" type="text" placeholder="Mensaje" id="message" />
        <button class="btn-send" id="btnSend">Enviar</button>
    </div>  

</div>

<div class="row">
    <div class="col-6">
        <div id="messages"></div>
    </div>
    <div class="col-6">
        <div id="notifications"></div>
    </div>

</div>

<script src="~/lib/signalr/dist/browser/signalr.min.js"></script>
<script src="~/lib/signalr/dist/browser/signalr.js"></script>
 <script>
    var connection = new signalR.HubConnectionBuilder().withUrl("/chatHub").build();
    connection.start().then(()=>{
         connection.invoke("AddToGroup", "@Model")
         }).catch((e)=>console.error(e));

     document.getElementById("btnSend").addEventListener ("click", (event)=>
     {
        let room="@Model";
        let user = document.getElementById("user").value;
        let message = document.getElementById("message").value;
        connection.invoke("SendMessage", room, user, message)
            .catch((err)=> console.error(err.toString()));
        
        document.getElementById("message").value="";
        document.getElementById("message").focus();
        event.preventDefault();
     })

     connection.on("ReceiveMessage", (user, message) =>{
        var message = "<div><b>" + user + " dijo: </b> " + message + "</div>";
        document.getElementById("messages").innerHTML = 
        message + document.getElementById("messages").innerHTML;
     });
     </script>